# Spring Vault 敏感信息泄漏漏洞 (CVE-2023-20859)
<figure class="wp-block-table">
    <table>
        <tbody>
        <tr>
            <td><strong>漏洞类型</strong></td>
            <td>未授权敏感信息泄露</td>
            <td><strong>发现时间</strong></td>
            <td>2023-03-22</td>
            <td><strong>漏洞等级</strong></td>
            <td>中危</td>
        </tr>
        <tr>
            <td><strong>MPS编号</strong></td>
            <td><a href="https://www.oscs1024.com/hd/MPS-2022-62831">MPS-2022-62831</a></td>
            <td><strong>CVE编号</strong></td>
            <td>CVE-2023-20859</td>
            <td><strong>漏洞影响广度</strong></td>
            <td>小</td>
        </tr>
        </tbody>
    </table>
</figure>


<figure class="wp-block-table">
    <h1 class="wp-block-heading">漏洞危害</h1>
    <table>
        <tbody>
        <tr>
            <td><strong>OSCS 描述</strong></td>
        </tr>
        <tr>
            <td>Spring Vault 是一个与 HashiCorp Vault 集成的Spring框架模块，它提供了一种方便的方式来管理敏感数据，如数据库密码、API密钥和加密密钥等。Batch 令牌是 Vault 中进行身份验证的一种方法，客户端需要有效的令牌才能与 Vault 交互。
Spring Vault 受影响版本中，应用程序在尝试撤销 Vault Batch 令牌时容易将敏感信息插入到日志文件中。当应用程序满足以下所有条件时容易受到攻击：
1、通过认证机制创建 Batch 令牌；
2、在仅使用命令式编程的情况下使用 LifecycleAwareSessionManager；
3、LifecycleAwareSessionManager.destroy() 方法会被应用程序或应用程序关闭钩子函数调用；
4、LifecycleAwareSessionManager 或 org.springframework.vault.authentication 的日志记录级别至少应设置为 WARN；
5、令牌撤销失败，原因可能是以下两种情况之一：
(1) Vault 错误响应，Batch 令牌无法撤销；
(2) 程序发生I/O错误。<br><em>参考链接：<a
                    href="https://www.oscs1024.com/hd/MPS-2022-62831">https://www.oscs1024.com/hd/MPS-2022-62831</a></em>
            </td>
        </tr>
        </tbody>
    </table>
</figure>


<figure class="wp-block-table alignleft">
    <h1 class="wp-block-heading">影响范围及处置方案</h1>
    <h2 class="wp-block-heading"><strong>OSCS</strong> <strong>平台影响范围和处置方案</strong></h2>
    <table>
        <tbody>
        <tr>
            <td>影响范围</td>
            <td>处置方式</td>
            <td>处置方法</td>
        </tr>
        <tr><td rowspan="1">org.springframework.vault:spring-vault [3.0.0, 3.0.2)</td><td>更新</td><td>升级org.springframework.vault:spring-vault到 2.3.3 或 3.0.2 更高版本</td></tr><tr><td rowspan="1">org.springframework.vault:spring-vault [1.0.0.RELEASE, 2.3.3)</td><td>更新</td><td>升级org.springframework.vault:spring-vault到 2.3.3 或 3.0.2 更高版本</td></tr>
        <tr>
            <td colspan="3"><em>参考链接：</em><em><a
                    href="https://www.oscs1024.com/hd/MPS-2022-62831">https://www.oscs1024.com/hd/MPS-2022-62831</a></em></td>
        </tr>
        </tbody>
    </table>
</figure>


<figure class="wp-block-table">
    <h1 class="wp-block-heading">排查方式</h1>
    <table>
        <tbody>
        <tr>
            <td><strong>方式1：使用漏洞检测CLI工具来排查</strong><em>使用文档：<a
                    href="https://www.murphysec.com/docs/faqs/integration/cli.html">https://www.murphysec.com/docs/faqs/integration/cli.html</a></em>
            </td>
        </tr>
        <tr>
            <td><strong>方式2：使用漏洞检测IDEA插件排查</strong><em>使用文档：<a
                    href="https://www.murphysec.com/docs/faqs/integration/jetbrains-ide-plugin.html">https://www.murphysec.com/docs/faqs/integration/jetbrains-ide-plugin.html</a></em>
            </td>
        </tr>
        <tr>
            <td><strong>方式3：接入GitLab进行漏洞检测排查</strong><em>使用文档：<a
                    href="https://www.murphysec.com/docs/faqs/integration/gitlab.html">https://www.murphysec.com/docs/faqs/integration/gitlab.html</a></em>
            </td>
        </tr>
        <tr>
            <td><strong>更多排查方式：</strong><em><a
                    href="https://www.murphysec.com/docs/faqs/integration/">https://www.murphysec.com/docs/faqs/integration/</a></em>
            </td>
        </tr>
        </tbody>
    </table>
</figure>